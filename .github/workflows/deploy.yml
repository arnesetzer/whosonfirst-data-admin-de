name: Run test cases

on:
  [push]
    
jobs:
  clone:
    name: clone test repo
    runs-on: ubuntu-latest
    steps:
    - name: Checkout private test repo
      uses: actions/checkout@v4
      with:
        repository: arnesetzer/pelias_rrp_testcases
        ssh-key: ${{ secrets.DEPLOY_KEY }}
        ref: master
  test:
    needs: clone
    name: run tests
    runs-on: ubuntu-latest
    steps:
      - name: cd correct dir
        run: cd pelias_rrp_testcases
      - name: run tests
        run: docker run --rm -i -v './pelias.json:/code/pelias.json' -v './test_cases:/code/pelias/fuzzy-tester/test_cases' pelias/fuzzy-tester -e prod